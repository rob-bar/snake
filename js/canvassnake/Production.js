function Fruit(a,b,c,d){a===undefined?this.img=new Image:this.img=a;b===undefined?this.life=3:this.life=b;c===undefined?this.gridPosition={x:0,y:0}:this.gridPosition=c;d===undefined?this.kind=0:this.kind=d;this.score=(d+1)*50}function Level(){Debugger.log("Level")}function BodyPart(a,b,c){a===undefined?this.position=0:this.position=a;c===undefined?this.direction=0:this.direction=c;b===undefined?this.gridPosition={x:0,y:0}:this.gridPosition=b}function Snake(a,b,c,d){function q(){var a=false;check:for(i=1;i<e.length;i++){if(e[0].gridPosition.x==e[i].gridPosition.x&&e[0].gridPosition.y==e[i].gridPosition.y){a=true;break check}}return a}function p(){var b={};switch(e[e.length-2].direction){case Snake.DIR_TOP_BOTTOM:case Snake.DIR_LEFT_BOTTOM:case Snake.DIR_RIGHT_BOTTOM:b=new BodyPart(e.length-2,{x:e[e.length-2].gridPosition.x,y:e[e.length-2].gridPosition.y},Snake.DIR_TOP_BOTTOM_TAIL);break;case Snake.DIR_BOTTOM_TOP:case Snake.DIR_LEFT_TOP:case Snake.DIR_RIGHT_TOP:b=new BodyPart(e.length-2,{x:e[e.length-2].gridPosition.x,y:e[e.length-2].gridPosition.y},Snake.DIR_BOTTOM_TOP_TAIL);break;case Snake.DIR_LEFT_RIGHT:case Snake.DIR_TOP_RIGHT:case Snake.DIR_BOTTOM_RIGHT:b=new BodyPart(e.length-2,{x:e[e.length-2].gridPosition.x,y:e[e.length-2].gridPosition.y},Snake.DIR_LEFT_RIGHT_TAIL);break;case Snake.DIR_RIGHT_LEFT:case Snake.DIR_TOP_LEFT:case Snake.DIR_BOTTOM_LEFT:b=new BodyPart(e.length-2,{x:e[e.length-2].gridPosition.x,y:e[e.length-2].gridPosition.y},Snake.DIR_RIGHT_LEFT_TAIL);break;default:break}e.splice(e.length-1,1);e.splice(e.length-1,1,b);for(i=2;i<a-1;i++){e[i].position+=1}}function o(a,b,c){Debugger.log("directionLookup");var d;if((a.gridPosition.x>b.gridPosition.x&&a.gridPosition.y>b.gridPosition.y||a.gridPosition.y==0&&b.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT)&&a.gridPosition.y==c.gridPosition.y&&a.gridPosition.x>c.gridPosition.x&&(a.gridPosition.y!=Game.PLAYFIELD_MAXPOSITION_HEIGHT||b.gridPosition.y!=0)){Debugger.log("DIR_TOP_RIGHT");if(a.gridPosition.y==0&&b.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT)Debugger.log("WATCH OUT TOP");d=Snake.DIR_TOP_RIGHT;return d}if((a.gridPosition.x<b.gridPosition.x&&a.gridPosition.y>b.gridPosition.y||a.gridPosition.y==0&&b.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT)&&a.gridPosition.y==c.gridPosition.y&&a.gridPosition.x<c.gridPosition.x&&(a.gridPosition.y!=Game.PLAYFIELD_MAXPOSITION_HEIGHT||b.gridPosition.y!=0)){Debugger.log("DIR_TOP_LEFT");if(a.gridPosition.y==0&&b.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT)Debugger.log("WATCH OUT TOP");d=Snake.DIR_TOP_LEFT;return d}if((a.gridPosition.x>b.gridPosition.x&&a.gridPosition.y<b.gridPosition.y||a.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT&&b.gridPosition.y==0)&&a.gridPosition.y==c.gridPosition.y&&a.gridPosition.x>c.gridPosition.x&&(a.gridPosition.y!=0||b.gridPosition.y!=Game.PLAYFIELD_MAXPOSITION_HEIGHT)){Debugger.log("DIR_BOTTOM_RIGHT");if(a.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT&&b.gridPosition.y==0)Debugger.log("WATCH OUT BOTTOM");d=Snake.DIR_BOTTOM_RIGHT;return d}if((a.gridPosition.x<b.gridPosition.x&&a.gridPosition.y<b.gridPosition.y||a.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT&&b.gridPosition.y==0)&&a.gridPosition.y==c.gridPosition.y&&a.gridPosition.x<c.gridPosition.x&&(a.gridPosition.y!=0||b.gridPosition.y!=Game.PLAYFIELD_MAXPOSITION_HEIGHT)){Debugger.log("DIR_BOTTOM_LEFT");if(a.gridPosition.y==Game.PLAYFIELD_MAXPOSITION_HEIGHT&&b.gridPosition.y==0)Debugger.log("WATCH OUT BOTTOM");d=Snake.DIR_BOTTOM_LEFT;return d}if((a.gridPosition.x>b.gridPosition.x&&a.gridPosition.y>b.gridPosition.y||a.gridPosition.x==0&&b.gridPosition.x==Game.PLAYFIELD_MAXPOSITION_WIDTH)&&a.gridPosition.x==c.gridPosition.x&&a.gridPosition.y>c.gridPosition.y&&(a.gridPosition.x!=Game.PLAYFIELD_MAXPOSITION_WIDTH||b.gridPosition.x!=0)){Debugger.log("DIR_LEFT_BOTTOM");d=Snake.DIR_LEFT_BOTTOM;return d}if((a.gridPosition.x>b.gridPosition.x&&a.gridPosition.y<b.gridPosition.y||a.gridPosition.x==0&&b.gridPosition.x==Game.PLAYFIELD_MAXPOSITION_WIDTH)&&a.gridPosition.x==c.gridPosition.x&&a.gridPosition.y<c.gridPosition.y&&(a.gridPosition.x!=Game.PLAYFIELD_MAXPOSITION_WIDTH||b.gridPosition.x!=0)){Debugger.log("DIR_LEFT_TOP");d=Snake.DIR_LEFT_TOP;return d}if((a.gridPosition.x<b.gridPosition.x&&a.gridPosition.y>b.gridPosition.y||a.gridPosition.x==Game.PLAYFIELD_MAXPOSITION_WIDTH&&b.gridPosition.x==0)&&a.gridPosition.x==c.gridPosition.x&&a.gridPosition.y>c.gridPosition.y&&(a.gridPosition.x!=0||b.gridPosition.x!=Game.PLAYFIELD_MAXPOSITION_WIDTH)){Debugger.log("DIR_RIGHT_BOTTOM");d=Snake.DIR_RIGHT_BOTTOM;return d}if((a.gridPosition.x<b.gridPosition.x&&a.gridPosition.y<b.gridPosition.y||a.gridPosition.x==Game.PLAYFIELD_MAXPOSITION_WIDTH&&b.gridPosition.x==0)&&a.gridPosition.x==c.gridPosition.x&&a.gridPosition.y<c.gridPosition.y&&(a.gridPosition.x!=0||b.gridPosition.x!=Game.PLAYFIELD_MAXPOSITION_WIDTH)){Debugger.log("DIR_RIGHT_TOP");d=Snake.DIR_RIGHT_TOP;return d}}function n(a){switch(g){case Snake.DIR_TOP_BOTTOM_FACE:case Snake.DIR_TOP_BOTTOM_FACE_EATING:var b=new BodyPart(1,{x:e[0].gridPosition.x,y:e[0].gridPosition.y},Snake.DIR_TOP_BOTTOM);e[0].gridPosition.y+=1;e[0].direction=Snake.DIR_TOP_BOTTOM_FACE;fruitCheck:for(i=0;i<a.length;i++){if(a[i].gridPosition.y==e[0].gridPosition.y+1&&a[i].gridPosition.x==e[0].gridPosition.x){e[0].direction=Snake.DIR_TOP_BOTTOM_FACE_EATING}}if(e[0].gridPosition.x!=e[1].gridPosition.x&&e[0].gridPosition.y!=e[1].gridPosition.y){b.direction=o(e[0],e[1],b)}if(e[0].gridPosition.y>Game.PLAYFIELD_MAXPOSITION_HEIGHT)e[0].gridPosition.y=0;e.splice(1,0,b);break;case Snake.DIR_BOTTOM_TOP_FACE:case Snake.DIR_BOTTOM_TOP_FACE_EATING:var b=new BodyPart(1,{x:e[0].gridPosition.x,y:e[0].gridPosition.y},Snake.DIR_BOTTOM_TOP);e[0].gridPosition.y-=1;e[0].direction=Snake.DIR_BOTTOM_TOP_FACE;fruitCheck:for(i=0;i<a.length;i++){if(a[i].gridPosition.y==e[0].gridPosition.y-1&&a[i].gridPosition.x==e[0].gridPosition.x){e[0].direction=Snake.DIR_BOTTOM_TOP_FACE_EATING}}if(e[0].gridPosition.x!=e[1].gridPosition.x&&e[0].gridPosition.y!=e[1].gridPosition.y){b.direction=o(e[0],e[1],b)}if(e[0].gridPosition.y<0)e[0].gridPosition.y=Game.PLAYFIELD_MAXPOSITION_HEIGHT;e.splice(1,0,b);break;case Snake.DIR_LEFT_RIGHT_FACE:case Snake.DIR_LEFT_RIGHT_FACE_EATING:var b=new BodyPart(1,{x:e[0].gridPosition.x,y:e[0].gridPosition.y},Snake.DIR_LEFT_RIGHT);e[0].gridPosition.x+=1;e[0].direction=Snake.DIR_LEFT_RIGHT_FACE;fruitCheck:for(i=0;i<a.length;i++){if(a[i].gridPosition.x==e[0].gridPosition.x+1&&a[i].gridPosition.y==e[0].gridPosition.y){e[0].direction=Snake.DIR_LEFT_RIGHT_FACE_EATING}}if(e[0].gridPosition.x!=e[1].gridPosition.x&&e[0].gridPosition.y!=e[1].gridPosition.y){b.direction=o(e[0],e[1],b)}if(e[0].gridPosition.x>Game.PLAYFIELD_MAXPOSITION_WIDTH)e[0].gridPosition.x=0;e.splice(1,0,b);break;case Snake.DIR_RIGHT_LEFT_FACE:case Snake.DIR_RIGHT_LEFT_FACE_EATING:var b=new BodyPart(1,{x:e[0].gridPosition.x,y:e[0].gridPosition.y},Snake.DIR_RIGHT_LEFT);e[0].gridPosition.x-=1;e[0].direction=Snake.DIR_RIGHT_LEFT_FACE;fruitCheck:for(i=0;i<a.length;i++){if(a[i].gridPosition.x==e[0].gridPosition.x-1&&a[i].gridPosition.y==e[0].gridPosition.y){e[0].direction=Snake.DIR_RIGHT_LEFT_FACE_EATING}}if(e[0].gridPosition.x!=e[1].gridPosition.x&&e[0].gridPosition.y!=e[1].gridPosition.y){b.direction=o(e[0],e[1],b)}if(e[0].gridPosition.x<0)e[0].gridPosition.x=Game.PLAYFIELD_MAXPOSITION_WIDTH;e.splice(1,0,b);break;default:break}}function m(a,b){if(jQuery.browser.mozilla){switch(a){case Snake.DIR_LEFT_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_BOTTOM_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_RIGHT_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_TOP_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_TOP_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_TOP_BOTTOM_TAIL:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_LEFT_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_LEFT_RIGHT_TAIL:b.shadowBlur=2;b.shadowOffsetX=-1;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_BOTTOM_TOP:case Snake.DIR_LEFT_TOP:case Snake.DIR_RIGHT_TOP:case Snake.DIR_RIGHT_LEFT:case Snake.DIR_TOP_LEFT:case Snake.DIR_BOTTOM_LEFT:case Snake.DIR_BOTTOM_TOP_TAIL:case Snake.DIR_RIGHT_LEFT_TAIL:case Snake.DIR_TOP_BOTTOM_FACE:case Snake.DIR_BOTTOM_TOP_FACE:case Snake.DIR_LEFT_RIGHT_FACE:case Snake.DIR_RIGHT_LEFT_FACE:case Snake.DIR_TOP_BOTTOM_FACE_EATING:case Snake.DIR_BOTTOM_TOP_FACE_EATING:case Snake.DIR_LEFT_RIGHT_FACE_EATING:case Snake.DIR_RIGHT_LEFT_FACE_EATING:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;default:break}}if(jQuery.browser.webkit){switch(a){case Snake.DIR_LEFT_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_BOTTOM_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_RIGHT_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_TOP_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.2)";break;case Snake.DIR_TOP_BOTTOM:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-2;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_TOP_BOTTOM_TAIL:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=-1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_LEFT_RIGHT:b.shadowBlur=2;b.shadowOffsetX=-2;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_LEFT_RIGHT_TAIL:b.shadowBlur=1;b.shadowOffsetX=-1;b.shadowOffsetY=0;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_RIGHT_TOP:b.shadowBlur=1;b.shadowOffsetX=0;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_BOTTOM_TOP_FACE:b.shadowBlur=1;b.shadowOffsetX=0;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;case Snake.DIR_BOTTOM_TOP:case Snake.DIR_LEFT_TOP:case Snake.DIR_RIGHT_LEFT:case Snake.DIR_TOP_LEFT:case Snake.DIR_BOTTOM_LEFT:case Snake.DIR_BOTTOM_TOP_TAIL:case Snake.DIR_RIGHT_LEFT_TAIL:case Snake.DIR_TOP_BOTTOM_FACE:case Snake.DIR_LEFT_RIGHT_FACE:case Snake.DIR_RIGHT_LEFT_FACE:case Snake.DIR_TOP_BOTTOM_FACE_EATING:case Snake.DIR_BOTTOM_TOP_FACE_EATING:case Snake.DIR_LEFT_RIGHT_FACE_EATING:case Snake.DIR_RIGHT_LEFT_FACE_EATING:b.shadowBlur=2;b.shadowOffsetX=1;b.shadowOffsetY=1;b.shadowColor="rgba(0,0,0,.5)";break;default:break}}}function l(a,b,c,d){var e=0;switch(d){case 1:if(a.gridPosition.x!=b.gridPosition.x){a.gridPosition.x>b.gridPosition.x?e=Snake.DIR_LEFT_RIGHT_FACE:e=Snake.DIR_RIGHT_LEFT_FACE}else if(a.gridPosition.y!=b.gridPosition.y){a.gridPosition.y>b.gridPosition.y?e=Snake.DIR_TOP_BOTTOM_FACE:e=Snake.DIR_BOTTOM_TOP_FACE}break;case 2:if(a.gridPosition.x!=b.gridPosition.x){a.gridPosition.x>b.gridPosition.x?e=Snake.DIR_LEFT_RIGHT_FACE_EATING:e=Snake.DIR_RIGHT_LEFT_FACE_EATING}else if(a.gridPosition.y!=b.gridPosition.y){a.gridPosition.y>b.gridPosition.y?e=Snake.DIR_TOP_BOTTOM_FACE_EATING:e=Snake.DIR_BOTTOM_TOP_FACE_EATING}break;case 3:if(c.gridPosition.x==b.gridPosition.x||c.gridPosition.y==b.gridPosition.y){if(c.gridPosition.x==b.gridPosition.x)c.gridPosition.y>b.gridPosition.y?e=Snake.DIR_TOP_BOTTOM:e=Snake.DIR_BOTTOM_TOP;if(c.gridPosition.y==b.gridPosition.y)c.gridPosition.x>b.gridPosition.x?e=Snake.DIR_LEFT_RIGHT:e=Snake.DIR_RIGHT_LEFT}else{if(c.gridPosition.x>b.gridPosition.x&&c.gridPosition.y>b.gridPosition.y&&c.gridPosition.y==a.gridPosition.y)e=Snake.DIR_TOP_RIGHT;if(c.gridPosition.x<b.gridPosition.x&&c.gridPosition.y>b.gridPosition.y&&c.gridPosition.y==a.gridPosition.y)e=Snake.DIR_TOP_LEFT;if(c.gridPosition.x>b.gridPosition.x&&c.gridPosition.y<b.gridPosition.y&&c.gridPosition.y==a.gridPosition.y)e=Snake.DIR_BOTTOM_RIGHT;if(c.gridPosition.x<b.gridPosition.x&&c.gridPosition.y<b.gridPosition.y&&c.gridPosition.y==a.gridPosition.y)e=Snake.DIR_BOTTOM_LEFT;if(c.gridPosition.x>b.gridPosition.x&&c.gridPosition.y>b.gridPosition.y&&c.gridPosition.x==a.gridPosition.x)e=Snake.DIR_LEFT_BOTTOM;if(c.gridPosition.x>b.gridPosition.x&&c.gridPosition.y<b.gridPosition.y&&c.gridPosition.x==a.gridPosition.x)e=Snake.DIR_LEFT_TOP;if(c.gridPosition.x<b.gridPosition.x&&c.gridPosition.y>b.gridPosition.y&&c.gridPosition.x==a.gridPosition.x)e=Snake.DIR_RIGHT_BOTTOM;if(c.gridPosition.x<b.gridPosition.x&&c.gridPosition.y<b.gridPosition.y&&c.gridPosition.x==a.gridPosition.x)e=Snake.DIR_RIGHT_TOP}break;case 4:if(a.gridPosition.x!=c.gridPosition.x){a.gridPosition.x<c.gridPosition.x?e=Snake.DIR_LEFT_RIGHT_TAIL:e=Snake.DIR_RIGHT_LEFT_TAIL}else if(a.gridPosition.y!=c.gridPosition.y){a.gridPosition.y<c.gridPosition.y?e=Snake.DIR_TOP_BOTTOM_TAIL:e=Snake.DIR_BOTTOM_TOP_TAIL}break;default:Debugger.log("ERROR IN DIRECTIONCHECK!");break}return e}function k(){Debugger.log("generateRandomSnake");var b=new BodyPart(0,{x:randomFromTo(10,25),y:randomFromTo(8,12)});e.push(b);for(i=1;i<a;i++){if(i>1){var c=e[i-2]}else{var c=null}var d=e[i-1];var f=null;if(Math.random()>.5){if(Math.random()>.5){f=new BodyPart(i,{x:d.gridPosition.x+1,y:d.gridPosition.y});if(c!=null){if(c.gridPosition.x==f.gridPosition.x&&c.gridPosition.y==f.gridPosition.y){f=new BodyPart(i,{x:d.gridPosition.x-1,y:d.gridPosition.y})}}}else{f=new BodyPart(i,{x:d.gridPosition.x-1,y:d.gridPosition.y});if(c!=null){if(c.gridPosition.x==f.gridPosition.x&&c.gridPosition.y==f.gridPosition.y){f=new BodyPart(i,{x:d.gridPosition.x+1,y:d.gridPosition.y})}}}}else{if(Math.random()>.5){f=new BodyPart(i,{x:d.gridPosition.x,y:d.gridPosition.y+1});if(c!=null){if(c.gridPosition.x==f.gridPosition.x&&c.gridPosition.y==f.gridPosition.y){f=new BodyPart(i,{x:d.gridPosition.x,y:d.gridPosition.y-1})}}}else{f=new BodyPart(i,{x:d.gridPosition.x,y:d.gridPosition.y-1});if(c!=null){if(c.gridPosition.x==f.gridPosition.x&&c.gridPosition.y==f.gridPosition.y){f=new BodyPart(i,{x:d.gridPosition.x,y:d.gridPosition.y+1})}}}}e.push(f)}for(i=0;i<e.length;i++){var h=e[i];if(i==0){h.direction=l(h,e[i+1],null,1);g=h.direction}else if(i==e.length-1){h.direction=l(h,null,e[i-1],4)}else{h.direction=l(h,e[i+1],e[i-1],3)}}}a===undefined?this.length=5:this.length=a;b===undefined?this.speed=1:this.speed=b;c===undefined?this.mode=Snake.MODE_NORMAL:this.mode=c;d===undefined?this.images={}:this.images=d;var e=[];var f=d;var g=null;var h=true;var j=false;this.initMe=function(){k()};this.drawSnake=function(a){for(i=0;i<e.length;i++){var b=Math.floor(e[i].direction%4)*BodyPart.DEFAULT_WIDTH;var d=Math.floor(e[i].direction/4)*BodyPart.DEFAULT_HEIGHT;m(e[i].direction,a);switch(c){case Snake.MODE_NORMAL:a.drawImage(f.normal,b,d,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT,e[i].gridPosition.x*BodyPart.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET,e[i].gridPosition.y*BodyPart.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT);break;case Snake.MODE_OVERDRIVE:a.drawImage(f.overdrive,b,d,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT,e[i].gridPosition.x*BodyPart.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET,e[i].gridPosition.y*BodyPart.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT);break;case Snake.MODE_SPECIAL:a.drawImage(f.special,b,d,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT,e[i].gridPosition.x*BodyPart.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET,e[i].gridPosition.y*BodyPart.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET,BodyPart.DEFAULT_WIDTH,BodyPart.DEFAULT_HEIGHT);break;default:break}a.shadowColor="#000000";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=0}};this.makeLonger=function(a){n(a);var b=q();return b};this.makeShorter=function(){p();h=true};this.changeDirection=function(a){h=false;g=a;e[0].direction=a};this.currentDirection=function(){return g};this.canBeMoved=function(){return h};this.head=function(){return e[0]};this.parts=function(){return e}}function TakeThePosition(a){Debugger.log("TakeThePosition");a===undefined?this.context=0:this.context=a}function InfinitHunger(a,b){function O(a){l=0;$(".lifeimg").remove();for(i=0;i<a;i++){$("#info-2").append("<span class='lifeimg'></span>")}}function N(a){if(m<a){l+=1;Debugger.log("levelMultiplier"+l);m=m*2;clearInterval(v);v=setInterval(H,1e3/(x.speed+l))}$("#info-1").text("score "+a)}function M(){var a=x.head();for(i=0;i<y.length;i++){if(y[i].life!=0){if(a.gridPosition.x==y[i].gridPosition.x&&a.gridPosition.y==y[i].gridPosition.y){h+=y[i].score;N(h);y.splice(i,1,L(null));return true}}}return false}function L(a){Debugger.log("createFruit");if(a!=null){z.push(a)}var b=randomFromTo(0,z.length);var c=z[b];var d=l;if(d>7){d=7}var e=new Fruit(s,new Number(randomFromTo(8-d*.5,12)),{x:c.x,y:c.y},randomFromTo(0,9));z.splice(b,1);return e}function K(){for(i=0;i<y.length;i++){if(y[i].life<=0){y.splice(i,1,L({x:y[i].gridPosition.x,y:y[i].gridPosition.y}))}y[i].draw(a,o)}}function J(){for(i=0;i<e;i++){y.push(L(null))}}function I(){$("#info-3").text("time "+n.getTimeString(SecMinTimer.min_sec))}function H(){a.clearRect(0,0,b.width,b.height);a.drawImage(o,Game.PLAYFIELD_XOFFSET-27,Game.PLAYFIELD_YOFFSET-48);a.drawImage(t.i,t._x,t._y);K();var c=x.makeLonger(y);F(x.parts()[0]);var d=M();if(!d){G(x.parts()[x.parts().length-1]);x.makeShorter()}if(!c){x.drawSnake(a)}else{clearInterval(v);clearInterval(w);function e(){f-=.05;if(f>0){a.globalAlpha=1;a.clearRect(0,0,b.width,b.height);a.drawImage(o,Game.PLAYFIELD_XOFFSET-27,Game.PLAYFIELD_YOFFSET-48);a.drawImage(t.i,t._x,t._y);a.globalAlpha=f;x.drawSnake(a)}else{f=0;a.globalAlpha=1;a.clearRect(0,0,b.width,b.height);a.drawImage(o,Game.PLAYFIELD_XOFFSET-27,Game.PLAYFIELD_YOFFSET-48);a.drawImage(t.i,t._x,t._y);k-=1;if(k>0){D()}else{E()}clearInterval(g)}}var f=1;var g=setInterval(e,getMillisecondsInterval(Game.frameRate))}}function G(a){z.push({x:a.gridPosition.x,y:a.gridPosition.y})}function F(a){freegrid:for(i=0;i<z.length;i++){if(a.gridPosition.x==z[i].x&&a.gridPosition.y==z[i].y){z.splice(i,1);break freegrid}}}function E(){f=Game.STATE_GAME_OVER;O(k);clearInterval(w);clearInterval(u);$("#game-over").css("visibility","visible");$("#game-over-score").text("SCORE : "+h);$("#game-over").animate({top:200},{duration:500,easing:"easeOutExpo"})}function D(){x=new Snake(d,c,Snake.MODE_NORMAL,{normal:p,overdrive:q,special:r});x.initSnake();x.drawSnake(a);N(h);O(k);v=setInterval(H,1e3/(x.speed+l*.5));w=setInterval(K,getMillisecondsInterval(Game.frameRate))}function C(){for(i=0;i<x.parts().length;i++){gridFor:for(j=0;j<z.length;j++){if(x.parts()[i].gridPosition.x==z[j].x&&x.parts()[i].gridPosition.y==z[j].y){z.splice(j,1);break gridFor}}}}function B(){for(rows=0;rows<Game.PLAYFIELD_MAXPOSITION_HEIGHT;rows++){for(colls=0;colls<Game.PLAYFIELD_MAXPOSITION_WIDTH;colls++){z.push({x:colls,y:rows})}}}function A(){g+=1;if(g==4){f=Game.STATE_IN_GAME;B();x=new Snake(d,c,Snake.MODE_NORMAL,{normal:p,overdrive:q,special:r});J();x.initSnake();x.drawSnake(a);C();N(h);O(k);u=setInterval(I,1e3);v=setInterval(H,1e3/(x.speed+l*.5));w=setInterval(K,getMillisecondsInterval(Game.frameRate))}}Debugger.log("InfinitHunger");a===undefined?this.context=0:this.context=a;b===undefined?this.canvas=0:this.canvas=b;const c=3;const d=5;const e=3;var f=Game.STATE_IN_GAME;var g=0;var h=0;var k=1;var l=0;var m=1e3;var n=new SecMinTimer;var o=new Image;var p=new Image;var q=new Image;var r=new Image;var s=new Image;var t={};var u=0;var v=0;var w=0;var x={};var y=[];var z=[];this.loadGame=function(){Debugger.log("startGame");p.src="images/snakeAssets/snake_tile_1.png";p.addEventListener("load",A,false);q.src="images/snakeAssets/snake_tile_2.png";q.addEventListener("load",A,false);r.src="images/snakeAssets/snake_tile_3.png";r.addEventListener("load",A,false);s.src="images/snakeAssets/fruits_tile.png";s.addEventListener("load",A,false)};this.stopGame=function(){clearInterval(this.intervalID)};this.replay=function(){f=Game.STATE_IN_GAME;h=0;k=1;n.reset();u=setInterval(I,1e3);D()};this.animateButtonsin=function(){$("#buttons-ingame").css("visibility","visible");$("#buttons-ingame").animate({opacity:1},500)};this.animateScoreBoardin=function(){$("#scoreboard").css("visibility","visible");$("#scoreboard").animate({opacity:1},500)};this.animateFooterin=function(){$("#footer").css("visibility","visible");$("#footer").animate({opacity:1},500)};this.animateShares=function(){$("#general-share-buttons").css("visibility","visible");$("#general-share-buttons").animate({opacity:1},500)};this.drawbg=function(c){function d(){function e(){if(a.globalAlpha<1){d+=.05;a.globalAlpha=d;a.clearRect(0,0,b.width,b.height);a.drawImage(o,Game.PLAYFIELD_XOFFSET-27,Game.PLAYFIELD_YOFFSET-48);a.globalAlpha=1;a.drawImage(t.i,t._x,t._y);a.globalAlpha=d}else{a.globalAlpha=1;a.clearRect(0,0,b.width,b.height);a.drawImage(o,Game.PLAYFIELD_XOFFSET-27,Game.PLAYFIELD_YOFFSET-48);a.drawImage(t.i,t._x,t._y);clearInterval(c)}}var c=setInterval(e,getMillisecondsInterval(Game.frameRate));var d=0}t=c;o.src="images/snakeAssets/level1__.png";o.addEventListener("load",d,false)};this.updateKeylist=function(a){if(x.canBeMoved()){if(a[38]==true){if(x.currentDirection()!=Snake.DIR_TOP_BOTTOM_FACE&&x.currentDirection()!=Snake.DIR_TOP_BOTTOM_FACE_EATING&&x.currentDirection()!=Snake.DIR_BOTTOM_TOP_FACE&&x.currentDirection()!=Snake.DIR_BOTTOM_TOP_FACE_EATING){x.changeDirection(Snake.DIR_BOTTOM_TOP_FACE)}}if(a[37]==true){if(x.currentDirection()!=Snake.DIR_LEFT_RIGHT_FACE&&x.currentDirection()!=Snake.DIR_LEFT_RIGHT_FACE_EATING&&x.currentDirection()!=Snake.DIR_RIGHT_LEFT_FACE&&x.currentDirection()!=Snake.DIR_RIGHT_LEFT_FACE_EATING){x.changeDirection(Snake.DIR_RIGHT_LEFT_FACE)}}if(a[39]==true){if(x.currentDirection()!=Snake.DIR_LEFT_RIGHT_FACE&&x.currentDirection()!=Snake.DIR_LEFT_RIGHT_FACE_EATING&&x.currentDirection()!=Snake.DIR_RIGHT_LEFT_FACE&&x.currentDirection()!=Snake.DIR_RIGHT_LEFT_FACE_EATING){x.changeDirection(Snake.DIR_LEFT_RIGHT_FACE)}}if(a[40]==true){if(x.currentDirection()!=Snake.DIR_TOP_BOTTOM_FACE&&x.currentDirection()!=Snake.DIR_TOP_BOTTOM_FACE_EATING&&x.currentDirection()!=Snake.DIR_BOTTOM_TOP_FACE&&x.currentDirection()!=Snake.DIR_BOTTOM_TOP_FACE_EATING){x.changeDirection(Snake.DIR_TOP_BOTTOM_FACE)}}}};this.getState=function(){return f}}function Game(a,b){function v(){if(g==true){$(".clearMeFocus").attr("disabled",true);$(".clearMeFocus").css("opacity",".3");$(".game-over-tt-btn1").css("opacity",".3");$(".game-over-tt-btn1").css("cursor","auto")}else{$(".clearMeFocus").attr("disabled",false);$(".clearMeFocus").css("opacity","1");u()}}function u(){if($(".clearMeFocus").val()!=""&&$(".clearMeFocus").val()!=$(".clearMeFocus").attr("title")){$(".game-over-tt-btn1").css("opacity","1");$(".game-over-tt-btn1").css("cursor","pointer")}else{$(".game-over-tt-btn1").css("opacity",".3");$(".game-over-tt-btn1").css("cursor","auto")}}function t(){Debugger.log("compl");$("#score-board").animate({top:125},{duration:500,easing:"easeOutExpo"})}function s(){$("#tooltip-game-over").animate({top:30,opacity:0},{duration:500,easing:"easeOutExpo",complete:function(){Debugger.log("ONCOMPLE");$("#tooltip-game-over").css("top","25px");$("#tooltip-game-over").css("visibility","hidden")}})}function r(){Debugger.log("this.activeGame => "+h);if(h===Game.STATE_INFINIT_HUNGER){j=new InfinitHunger(a,b);var c={i:m,_x:Math.round(b.width*.5-m.width*.5),_y:k.endY};j.initInfinitHunger(c)}else{j=new TakeThePosition(a,b)}}function q(){a.globalAlpha-=.05;a.clearRect(0,0,b.width,b.height);a.drawImage(l,Math.round(b.width*.5-l.width*.5),Math.round(b.height*.5-l.height*.3));if(a.globalAlpha<=.05){a.globalAlpha=1;a.clearRect(0,0,b.width,b.height);var c=k.endY-k.beginY;k.velocityY=c*.1;k.beginY+=k.velocityY;a.drawImage(m,Math.round(b.width*.5-m.width*.5),k.beginY);if(c>-.1){a.drawImage(m,Math.round(b.width*.5-m.width*.5),k.endY);clearInterval(i);r()}a.globalAlpha=0}else{var d=a.globalAlpha;a.globalAlpha=1;a.drawImage(m,Math.round(b.width*.5-m.width*.5),Math.round(b.height*.4-m.height*.6));a.globalAlpha=d}}function p(){n+=1;Debugger.log(n);if(n>=2){Debugger.log(n);k.beginY=Math.round(b.height*.4-m.height*.6);a.drawImage(l,Math.round(b.width*.5-l.width*.5),Math.round(b.height*.5-l.height*.3));a.drawImage(m,Math.round(b.width*.5-m.width*.5),k.beginY);k.endY=5}}a===undefined?this.context=0:this.context=a;b===undefined?this.canvas=0:this.canvas=b;var c="";var d=0;var e=0;var f=false;var g=false;var h="STATE_TITLE";var i=0;var j;var k={};var l=new Image;var m=new Image;var n=0;var o=[];this.drawTitleScreen=function(){l.src="images/snakeAssets/intro_screen.png";l.addEventListener("load",p,false);m.src="images/snakeAssets/snake_title.png";m.addEventListener("load",p,false)};this.removeTitleScreen=function(){$("#buttons-introscreen").css("visibility","hidden");i=setInterval(q,getMillisecondsInterval(Game.frameRate))};this.setGameState=function(a){h=a};this.getGameState=function(){return h};$(document).keydown(function(a){o[a.keyCode]=true;j.updateKeylist(o)});$(document).keyup(function(a){o[a.keyCode]=false;j.updateKeylist(o)});$("#btn-1-game-over").click(function(){function a(){Debugger.log("compl");f=false;g=false;j.replay()}s();$("#game-over").animate({top:-250},{duration:500,easing:"easeOutExpo",complete:a});return false});$("#btn-2-game-over").click(function(){var a=$("#game-over-score").text();a=a.substring(8,a.length);$.ajax({type:"GET",url:"games/canvassnakeajaxgeturlscoretwitter/"+a,success:function(a){$(".game-over-tt-btn3").attr("href",a)}});$.ajax({type:"GET",url:"games/canvassnakeajaxgeturlscorefacebook/"+a,success:function(a){$(".game-over-tt-btn2").attr("href",a)}});u();v();$("#tooltip-game-over").css("visibility","visible");$("#tooltip-game-over").animate({top:30,opacity:1},{duration:500,easing:"easeOutExpo",complete:function(){}})});$("#game-over").mouseleave(function(){s()});$("#btn-3-game-over").click(function(){s();if(!f){$.ajax({type:"GET",url:"games/canvassnakeajaxgetscores",success:function(a){f=true;$("#score-board-tbl2").empty();$("#score-board-tbl2").append(a);$("#game-over").animate({top:-250},{duration:500,easing:"easeOutExpo",complete:t})}})}else{$("#game-over").animate({top:-250},{duration:500,easing:"easeOutExpo",complete:t})}return false});$("#btn-1-score-board").click(function(){function a(){Debugger.log("compl");f=false;g=false;j.replay()}$("#score-board").animate({top:-400},{duration:500,easing:"easeOutExpo",complete:a});return false});$("#btn-4-score-board").click(function(){function a(){Debugger.log("compl");$("#game-over").animate({top:200},{duration:500,easing:"easeOutExpo"})}$("#score-board").animate({top:-400},{duration:500,easing:"easeOutExpo",complete:a});return false});$(".game-over-tt-btn1").click(function(){Debugger.log("$(this).css('opacity')"+$(this).css("opacity"));if($(this).css("opacity")==1){if(!g){var a={name:$("#txt-name-tt1").val(),score:$("#game-over-score").text(),time:$("#info-3").text()};$.ajax({url:"games/canvassnakeSaveScore",type:"POST",data:a,success:function(){g=true;f=false;v()}})}}return false});$(".clearMeFocus").focus(function(){if($(this).val()==$(this).attr("title")){c=$(this).val();$(this).val("")}});$(".clearMeFocus").blur(function(){if($(this).val()==""){$(this).val(c)}});$(".clearMeFocus").keyup(function(){u()});$(".score-board-btn").mouseenter(function(){Debugger.log("Hover");$(this).animate({backgroundPosition:"-20 0"},{duration:500,easing:"easeOutExpo"})});$(".score-board-btn").mouseleave(function(){Debugger.log("Out");$(this).animate({backgroundPosition:"-30 0"},{duration:500,easing:"easeOutExpo"})});$("#score-board-btndown").click(function(){Debugger.log("tblposcntr = "+d);Debugger.log("Math.floor($('#score-board-tbl2 tr').size() /10)"+Math.floor($("#score-board-tbl2 tr").size()/10));if(d<Math.floor($("#score-board-tbl2 tr").size()/10)-1){d++;$("#score-board-tbl2").animate({top:-210*d},{duration:1e3,easing:"easeInOutQuint"})}return false});$("#score-board-btnup").click(function(){Debugger.log("tblposcntr = "+d);if(d>0){d--;$("#score-board-tbl2").animate({top:-210*d},{duration:1e3,easing:"easeInOutQuint"})}return false});$("#btn-1-share").mouseenter(function(){Debugger.log("test");$("#balloon-1").css("opacity","1");$("#balloon-2").css("opacity","0")});$("#btn-1-share").mouseleave(function(){$("#balloon-1").css("opacity","0")});$("#btn-2-share").mouseenter(function(){Debugger.log("test2");$("#balloon-2").css("opacity","1");$("#balloon-1").css("opacity","0")});$("#btn-2-share").mouseleave(function(){$("#balloon-2").css("opacity","0")})}Game.prototype.setGameMode=function(a){if(a===Game.STATE_INFINIT_HUNGER||a===Game.STATE_TAKE_THE_POSITION){this.setGameState(a);$("#buttons-introscreen").animate({opacity:0},1e3,this.removeTitleScreen)}};Game.STATE_TITLE="STATE_TITLE";Game.STATE_INFINIT_HUNGER="STATE_INFINIT_HUNGER";Game.STATE_TAKE_THE_POSITION="STATE_TAKE_THE_POSITION";Game.STATE_IN_GAME="STATE_IN_GAME";Game.STATE_GAME_OVER="STATE_GAME_OVER";Game.frameRate=60;Game.PLAYFIELD_XOFFSET=50;Game.PLAYFIELD_YOFFSET=100;Game.PLAYFIELD_MAXPOSITION_WIDTH=35;Game.PLAYFIELD_MAXPOSITION_HEIGHT=17;InfinitHunger.prototype.initInfinitHunger=function(a){this.drawbg(a);$("#ingame").css("visibility","visible");$("#btn-1-ingame").css("background-position","-138px 0");$("#btn-1-ingame").css("cursor","auto");setTimeout(this.animateButtonsin,500);setTimeout(this.animateScoreBoardin,1e3);setTimeout(this.animateShares,1150);setTimeout(this.animateFooterin,1300);setTimeout(this.loadGame,1500)};Snake.prototype.initSnake=function(){this.initMe()};Snake.MODE_NORMAL="MODE_NORMAL";Snake.MODE_OVERDRIVE="MODE_OVERDRIVE";Snake.MODE_SPECIAL="MODE_SPECIAL";Snake.DIR_TOP_BOTTOM=0;Snake.DIR_BOTTOM_TOP=1;Snake.DIR_LEFT_RIGHT=2;Snake.DIR_RIGHT_LEFT=3;Snake.DIR_TOP_RIGHT=4;Snake.DIR_TOP_LEFT=5;Snake.DIR_BOTTOM_RIGHT=6;Snake.DIR_BOTTOM_LEFT=7;Snake.DIR_LEFT_BOTTOM=8;Snake.DIR_LEFT_TOP=9;Snake.DIR_RIGHT_BOTTOM=10;Snake.DIR_RIGHT_TOP=11;Snake.DIR_TOP_BOTTOM_TAIL=12;Snake.DIR_BOTTOM_TOP_TAIL=13;Snake.DIR_LEFT_RIGHT_TAIL=14;Snake.DIR_RIGHT_LEFT_TAIL=15;Snake.DIR_TOP_BOTTOM_FACE=16;Snake.DIR_BOTTOM_TOP_FACE=17;Snake.DIR_LEFT_RIGHT_FACE=18;Snake.DIR_RIGHT_LEFT_FACE=19;Snake.DIR_TOP_BOTTOM_FACE_EATING=20;Snake.DIR_BOTTOM_TOP_FACE_EATING=21;Snake.DIR_LEFT_RIGHT_FACE_EATING=22;Snake.DIR_RIGHT_LEFT_FACE_EATING=23;BodyPart.DEFAULT_WIDTH=25;BodyPart.DEFAULT_HEIGHT=25;Fruit.prototype.draw=function(a,b){var c=Math.floor(this.kind%5)*BodyPart.DEFAULT_WIDTH;var d=Math.floor(this.kind/5)*BodyPart.DEFAULT_HEIGHT;a.clearRect(this.gridPosition.x*Fruit.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET-1,this.gridPosition.y*Fruit.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET-1,29,29);a.drawImage(b,26+this.gridPosition.x*Fruit.DEFAULT_WIDTH,47+this.gridPosition.y*Fruit.DEFAULT_HEIGHT,Fruit.DEFAULT_WIDTH+4,Fruit.DEFAULT_HEIGHT+4,this.gridPosition.x*Fruit.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET-1,this.gridPosition.y*Fruit.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET-1,Fruit.DEFAULT_WIDTH+4,Fruit.DEFAULT_HEIGHT+4);if(this.life<=1){this.life-=.05;a.globalAlpha=this.life.toFixed(2);if(this.life<=0)a.globalAlpha=0}else{this.life-=.02;a.globalAlpha=1}if(jQuery.browser.webkit){a.shadowColor="rgba(0,0,0,.5)";a.shadowOffsetX=1;a.shadowOffsetY=.5;a.shadowBlur=1.5}if(jQuery.browser.mozilla){a.shadowColor="rgba(0,0,0,.5)";a.shadowOffsetX=1;a.shadowOffsetY=1;a.shadowBlur=1.5}a.drawImage(this.img,c,d,Fruit.DEFAULT_WIDTH,Fruit.DEFAULT_HEIGHT,this.gridPosition.x*Fruit.DEFAULT_WIDTH+Game.PLAYFIELD_XOFFSET,this.gridPosition.y*Fruit.DEFAULT_HEIGHT+Game.PLAYFIELD_YOFFSET,Fruit.DEFAULT_WIDTH,Fruit.DEFAULT_HEIGHT);a.shadowColor="#000000";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=0;a.globalAlpha=1};Fruit.KIND_APPLE_GREEN=0;Fruit.KIND_MANGO=1;Fruit.KIND_LEMON=2;Fruit.KIND_APPLE_RED=3;Fruit.KIND_PEACH=4;Fruit.KIND_PEAR=5;Fruit.KIND_CHERRY=6;Fruit.KIND_STRAWBERRY=7;Fruit.KIND_DRAPPES_BLUE=8;Fruit.KIND_DRAPPES_GREEN=9;Fruit.DEFAULT_WIDTH=25;Fruit.DEFAULT_HEIGHT=25